<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bike Fit Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 3fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            height: fit-content;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.2em;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 80px;
            gap: 10px;
            margin-bottom: 12px;
            align-items: center;
        }

        .form-row label {
            font-weight: 500;
            color: #2c3e50;
        }

        .form-row input {
            padding: 8px 12px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-row input:focus {
            outline: none;
            border-color: #3498db;
        }

        .bike-diagram {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .bike-diagram h3 {
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .results-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            height: fit-content;
        }

        .results-section h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.3em;
            border-bottom: 2px solid #27ae60;
            padding-bottom: 5px;
        }

        .result-item {
            background: white;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 4px solid #27ae60;
        }

        .result-item h4 {
            color: #2c3e50;
            margin-bottom: 8px;
        }

        .result-value {
            font-size: 1.4em;
            font-weight: bold;
            color: #27ae60;
        }

        .result-status {
            margin-top: 5px;
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .validation-section {
            background: #e8f5e8;
            border: 1px solid #27ae60;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .validation-section h4 {
            color: #27ae60;
            margin-bottom: 10px;
        }

        .test-button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }

        .test-button:hover {
            background: #2980b9;
        }

        .warning {
            color: #e74c3c;
            font-weight: bold;
        }

        .success {
            color: #27ae60;
            font-weight: bold;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .measurement-line {
            stroke: #e74c3c;
            stroke-width: 2;
            marker-end: url(#arrowhead);
        }

        .measurement-text {
            font-family: Arial, sans-serif;
            font-size: 12px;
            fill: #e74c3c;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üö¥‚Äç‚ôÇÔ∏è Bike Fit Calculator</h1>
            <p>Calculate seatpost setback, stem length/angle, and spacer height based on frame geometry and fit requirements</p>
        </div>

        <div class="main-content">
            <!-- Input Section -->
            <div class="input-section">
                <div class="input-group">
                    <h3>Frame Geometry (mm/degrees)</h3>
                    <div class="form-row">
                        <label for="reach">Reach:</label>
                        <input type="number" id="reach" step="0.1" placeholder="378">
                    </div>
                    <div class="form-row">
                        <label for="stack">Stack:</label>
                        <input type="number" id="stack" step="0.1" placeholder="580">
                    </div>
                    <div class="form-row">
                        <label for="topTube">Top Tube (effective):</label>
                        <input type="number" id="topTube" step="0.1" placeholder="548">
                    </div>
                    <div class="form-row">
                        <label for="seatTube">Seat Tube C-T:</label>
                        <input type="number" id="seatTube" step="0.1" placeholder="536">
                    </div>
                    <div class="form-row">
                        <label for="headAngle">Head Angle:</label>
                        <input type="number" id="headAngle" step="0.1" placeholder="72.25">
                    </div>
                    <div class="form-row">
                        <label for="seatAngle">Seat Angle:</label>
                        <input type="number" id="seatAngle" step="0.1" placeholder="73.75">
                    </div>
                    <div class="form-row">
                        <label for="headTube">Head Tube:</label>
                        <input type="number" id="headTube" step="0.1" placeholder="157">
                    </div>
                    <div class="form-row">
                        <label for="bbDrop">BB Drop:</label>
                        <input type="number" id="bbDrop" step="0.1" placeholder="72">
                    </div>
                </div>

                <div class="input-group">
                    <h3>Required Bike Fit (mm)</h3>
                    <div class="form-row">
                        <label for="saddleHeight">Saddle Height:</label>
                        <input type="number" id="saddleHeight" step="0.1" placeholder="760">
                    </div>
                    <div class="form-row">
                        <label for="saddleTipToBB">Tip of Saddle to BB:</label>
                        <input type="number" id="saddleTipToBB" step="0.1" placeholder="91">
                    </div>
                    <div class="form-row">
                        <label for="saddleToBarHeight">Saddle to Bar Height Diff:</label>
                        <input type="number" id="saddleToBarHeight" step="0.1" placeholder="-64">
                    </div>
                    <div class="form-row">
                        <label for="saddleTipToBarCenter">Tip of Saddle to Bar Center:</label>
                        <input type="number" id="saddleTipToBarCenter" step="0.1" placeholder="550">
                    </div>
                </div>

                <div class="input-group">
                    <h3>Component Options</h3>
                    <div class="form-row">
                        <label for="saddleLength">Saddle Length:</label>
                        <input type="number" id="saddleLength" step="0.1" value="250" placeholder="250">
                    </div>
                    <div class="form-row">
                        <label for="stemAngle">Stem Angle:</label>
                        <input type="number" id="stemAngle" step="1" value="-6" placeholder="-6">
                    </div>
                    <div class="form-row">
                        <label for="saddleRailPosition">Saddle Rail Position:</label>
                        <input type="number" id="saddleRailPosition" step="1" value="0" placeholder="0" title="mm fore(+) or aft(-) from center">
                    </div>
                </div>

                <div class="validation-section">
                    <h4>Test with 54T Strael</h4>
                    <button class="test-button" onclick="loadStrael54T()">Load Test Data</button>
                    <div id="testResults" style="margin-top: 10px;"></div>
                </div>
            </div>

            <!-- Bike Diagram -->
            <div class="bike-diagram">
                <h3>Bike Geometry Visualization</h3>
                <svg id="bikeSvg" width="800" height="600" viewBox="0 0 800 600">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="currentColor" />
                        </marker>
                    </defs>
                    <!-- Bike frame will be drawn here -->
                </svg>
            </div>

            <!-- Results Section -->
            <div class="results-section">
                <h3>üîß Component Recommendations</h3>
                
                <div class="result-item">
                    <h4>Seatpost Setback</h4>
                    <div class="result-value" id="seatpostSetback">-- mm</div>
                    <div class="result-status" id="seatpostStatus">Enter measurements</div>
                </div>

                <div class="result-item">
                    <h4>Stem Length</h4>
                    <div class="result-value" id="stemLength">-- mm</div>
                    <div class="result-status" id="stemStatus">Enter measurements</div>
                </div>

                <div class="result-item">
                    <h4>Headset Spacers</h4>
                    <div class="result-value" id="spacerHeight">-- mm</div>
                    <div class="result-status" id="spacerStatus">Enter measurements</div>
                </div>

                <div class="result-item">
                    <h4>Effective Top Tube</h4>
                    <div class="result-value" id="effectiveTopTube">-- mm</div>
                    <div class="result-status" id="topTubeStatus">Calculated reach</div>
                </div>

                <div class="input-group" style="margin-top: 30px;">
                    <h3>üìã Shopping List</h3>
                    <div id="shoppingList" style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px;">
                        Enter measurements to generate component list
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simplified frame geometry visualization
        function calculateBikeFit() {
            // Get frame geometry values
            const reach = parseFloat(document.getElementById('reach').value) || 378;
            const stack = parseFloat(document.getElementById('stack').value) || 580;
            const headAngle = parseFloat(document.getElementById('headAngle').value) || 72.25;
            const seatAngle = parseFloat(document.getElementById('seatAngle').value) || 73.75;
            const headTube = parseFloat(document.getElementById('headTube').value) || 157;
            const bbDrop = parseFloat(document.getElementById('bbDrop').value) || 72;
            
            // For now, just show placeholder values for calculations
            // We'll focus on getting the frame geometry right first
            const seatpostSetback = 25; // Placeholder
            const stemLength = 90; // Placeholder  
            const spacerHeight = 20; // Placeholder
            const effectiveTopTube = reach + 90; // Placeholder calculation

            // Update results with placeholder values
            updateResults({
                seatpostSetback: seatpostSetback,
                stemLength: stemLength,
                spacerHeight: spacerHeight,
                effectiveTopTube: effectiveTopTube
            });

            // Draw the bike frame with actual geometry
            drawBikeDiagram({
                reach, stack, headAngle, seatAngle, headTube, bbDrop
            });
        }

        function updateResults(results) {
            // Seatpost setback
            document.getElementById('seatpostSetback').textContent = results.seatpostSetback + ' mm';
            const seatpostStatus = document.getElementById('seatpostStatus');
            if (results.seatpostSetback < 20) {
                seatpostStatus.innerHTML = '<span class="warning">‚ö†Ô∏è Below recommended range (20-30mm)</span>';
            } else if (results.seatpostSetback > 30) {
                seatpostStatus.innerHTML = '<span class="warning">‚ö†Ô∏è Above recommended range (20-30mm)</span>';
            } else {
                seatpostStatus.innerHTML = '<span class="success">‚úÖ Within recommended range</span>';
            }

            // Stem length
            document.getElementById('stemLength').textContent = Math.round(results.stemLength) + ' mm';
            const stemStatus = document.getElementById('stemStatus');
            const stemLengthRounded = Math.round(results.stemLength);
            if (stemLengthRounded < 80) {
                stemStatus.innerHTML = '<span class="warning">‚ö†Ô∏è Below recommended range (80-110mm)</span>';
            } else if (stemLengthRounded > 110) {
                stemStatus.innerHTML = '<span class="warning">‚ö†Ô∏è Above recommended range (80-110mm)</span>';
            } else {
                stemStatus.innerHTML = '<span class="success">‚úÖ Within recommended range</span>';
            }

            // Spacer height
            document.getElementById('spacerHeight').textContent = results.spacerHeight + ' mm';
            const spacerStatus = document.getElementById('spacerStatus');
            if (results.spacerHeight > 40) {
                spacerStatus.innerHTML = '<span class="warning">‚ö†Ô∏è Above maximum (40mm)</span>';
            } else {
                spacerStatus.innerHTML = '<span class="success">‚úÖ Within limits</span>';
            }

            // Effective top tube
            document.getElementById('effectiveTopTube').textContent = results.effectiveTopTube + ' mm';

            // Update shopping list
            updateShoppingList(results);
        }

        function updateShoppingList(results) {
            const shoppingList = `
                <strong>üéØ Step 3: Head Tube Added</strong><br><br>
                üìè <strong>Reach:</strong> ${document.getElementById('reach').value}mm<br>
                üìê <strong>Stack:</strong> ${document.getElementById('stack').value}mm<br>
                ü™ë <strong>Seat Angle:</strong> ${document.getElementById('seatAngle').value}¬∞<br>
                üìè <strong>Seat Tube C-T:</strong> ${document.getElementById('seatTube').value}mm<br>
                üîß <strong>Head Angle:</strong> ${document.getElementById('headAngle').value}¬∞<br>
                üìè <strong>Head Tube:</strong> ${document.getElementById('headTube').value}mm<br><br>
                <strong>‚úÖ What you should see:</strong><br>
                ‚Ä¢ Red BB center point<br>
                ‚Ä¢ Blue head tube top point<br>
                ‚Ä¢ Red reach line (horizontal)<br>
                ‚Ä¢ Blue stack line (vertical)<br>
                ‚Ä¢ Dark gray seat tube (from BB)<br>
                ‚Ä¢ Orange seat tube measurement<br>
                ‚Ä¢ Dark gray head tube (angled)<br>
                ‚Ä¢ Purple head tube measurement<br><br>
                <em>Now we have both main frame tubes!</em>
            `;
            document.getElementById('shoppingList').innerHTML = shoppingList;
        }

        function drawBikeDiagram(params) {
            const svg = document.getElementById('bikeSvg');
            const scale = 0.6; // Adjusted scale to fit better
            const offsetX = 100;
            const offsetY = 100;
            
            // Clear previous drawing
            svg.innerHTML = svg.querySelector('defs').outerHTML;

            // Bottom bracket is our origin point - positioned to allow space for measurements
            const bbX = offsetX + 200;
            const bbY = offsetY + 450; // More space above for stack measurement

            // Frame geometry values
            const reach = params.reach || 378;
            const stack = params.stack || 580;
            const seatAngle = params.seatAngle || 73.75;
            const seatTube = params.seatTube || 536;
            const headAngle = params.headAngle || 72.25;
            const headTube = params.headTube || 157;

            // Head tube top position (scaled) - still needed for measurements
            const headTubeTopX = bbX + (reach * scale);
            const headTubeTopY = bbY - (stack * scale);

            // Calculate seat tube top position
            // Seat angle is measured from horizontal, seat tube leans back slightly  
            const seatAngleRad = (seatAngle * Math.PI) / 180;
            const seatTubeCTLength = seatTube * scale; // Use actual C-T measurement scaled
            const seatTubeTopX = bbX - (seatTubeCTLength) * Math.cos(seatAngleRad);
            const seatTubeTopY = bbY - (seatTubeCTLength) * Math.sin(seatAngleRad);

            // Calculate head tube bottom position
            // Head angle is measured from horizontal (72.25¬∞ clockwise from horizontal)
            const headAngleRad = (headAngle * Math.PI) / 180;
            const headTubeBottomX = headTubeTopX + (headTube * scale) * Math.cos(headAngleRad);
            const headTubeBottomY = headTubeTopY + (headTube * scale) * Math.sin(headAngleRad);

            // === STEP 3: BB, STACK, REACH + SEAT TUBE + HEAD TUBE ===
            
            // 1. Draw Bottom Bracket (origin point)
            const bbCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            bbCircle.setAttribute('cx', bbX);
            bbCircle.setAttribute('cy', bbY);
            bbCircle.setAttribute('r', 8);
            bbCircle.setAttribute('fill', '#e74c3c');
            bbCircle.setAttribute('stroke', '#c0392b');
            bbCircle.setAttribute('stroke-width', '2');
            svg.appendChild(bbCircle);

            // 2. Draw Head Tube Top point
            const headTubeTopCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            headTubeTopCircle.setAttribute('cx', headTubeTopX);
            headTubeTopCircle.setAttribute('cy', headTubeTopY);
            headTubeTopCircle.setAttribute('r', 4);
            headTubeTopCircle.setAttribute('fill', '#3498db');
            headTubeTopCircle.setAttribute('stroke', '#2980b9');
            headTubeTopCircle.setAttribute('stroke-width', '1');
            svg.appendChild(headTubeTopCircle);

            // 3. Draw REACH measurement (horizontal) - OVERLAID on actual measurement
            const reachLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            reachLine.setAttribute('x1', bbX);
            reachLine.setAttribute('y1', bbY); // Direct from BB center
            reachLine.setAttribute('x2', headTubeTopX);
            reachLine.setAttribute('y2', bbY); // Horizontal line at BB level
            reachLine.setAttribute('stroke', '#e74c3c');
            reachLine.setAttribute('stroke-width', '3');
            reachLine.setAttribute('stroke-dasharray', '5,5'); // Dashed line
            svg.appendChild(reachLine);

            // REACH label - positioned above the line
            const reachText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            reachText.setAttribute('x', (bbX + headTubeTopX) / 2);
            reachText.setAttribute('y', bbY - 10);
            reachText.setAttribute('text-anchor', 'middle');
            reachText.setAttribute('class', 'measurement-text');
            reachText.setAttribute('font-weight', 'bold');
            reachText.textContent = `REACH: ${reach}mm`;
            svg.appendChild(reachText);

            // 4. Draw STACK measurement (vertical) - OVERLAID on actual measurement
            const stackLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            stackLine.setAttribute('x1', bbX); // Direct from BB center
            stackLine.setAttribute('y1', bbY);
            stackLine.setAttribute('x2', bbX); // Vertical line at BB X position
            stackLine.setAttribute('y2', headTubeTopY);
            stackLine.setAttribute('stroke', '#3498db');
            stackLine.setAttribute('stroke-width', '3');
            stackLine.setAttribute('stroke-dasharray', '5,5'); // Dashed line
            svg.appendChild(stackLine);

            // STACK label - positioned beside the line
            const stackText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            stackText.setAttribute('x', bbX + 15);
            stackText.setAttribute('y', (bbY + headTubeTopY) / 2);
            stackText.setAttribute('text-anchor', 'start');
            stackText.setAttribute('class', 'measurement-text');
            stackText.setAttribute('font-weight', 'bold');
            stackText.setAttribute('transform', `rotate(-90, ${bbX + 15}, ${(bbY + headTubeTopY) / 2})`);
            stackText.textContent = `STACK: ${stack}mm`;
            svg.appendChild(stackText);

            // 5. Draw SEAT TUBE (connects directly to BB)
            const seatTubeElement = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            seatTubeElement.setAttribute('x1', bbX);
            seatTubeElement.setAttribute('y1', bbY);
            seatTubeElement.setAttribute('x2', seatTubeTopX);
            seatTubeElement.setAttribute('y2', seatTubeTopY);
            seatTubeElement.setAttribute('stroke', '#34495e');
            seatTubeElement.setAttribute('stroke-width', '6');
            seatTubeElement.setAttribute('stroke-linecap', 'round');
            svg.appendChild(seatTubeElement);

            // Seat tube angle measurement line
            const seatTubeAngleLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            seatTubeAngleLine.setAttribute('x1', bbX);
            seatTubeAngleLine.setAttribute('y1', bbY);
            seatTubeAngleLine.setAttribute('x2', seatTubeTopX);
            seatTubeAngleLine.setAttribute('y2', seatTubeTopY);
            seatTubeAngleLine.setAttribute('stroke', '#e67e22');
            seatTubeAngleLine.setAttribute('stroke-width', '2');
            seatTubeAngleLine.setAttribute('stroke-dasharray', '3,3');
            svg.appendChild(seatTubeAngleLine);

            // Mark the C-T point (same as seat tube end)
            const seatTubeCTPoint = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            seatTubeCTPoint.setAttribute('cx', seatTubeTopX);
            seatTubeCTPoint.setAttribute('cy', seatTubeTopY);
            seatTubeCTPoint.setAttribute('r', 3);
            seatTubeCTPoint.setAttribute('fill', '#e67e22');
            svg.appendChild(seatTubeCTPoint);

            // Seat tube C-T measurement line (same as seat tube)
            const seatTubeCTMeasureLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            seatTubeCTMeasureLine.setAttribute('x1', bbX);
            seatTubeCTMeasureLine.setAttribute('y1', bbY);
            seatTubeCTMeasureLine.setAttribute('x2', seatTubeTopX);
            seatTubeCTMeasureLine.setAttribute('y2', seatTubeTopY);
            seatTubeCTMeasureLine.setAttribute('stroke', '#e67e22');
            seatTubeCTMeasureLine.setAttribute('stroke-width', '3');
            seatTubeCTMeasureLine.setAttribute('stroke-dasharray', '5,5');
            svg.appendChild(seatTubeCTMeasureLine);

            // Seat tube C-T label
            const seatTubeCTText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            seatTubeCTText.setAttribute('x', seatTubeTopX - 60);
            seatTubeCTText.setAttribute('y', (bbY + seatTubeTopY) / 2);
            seatTubeCTText.setAttribute('class', 'measurement-text');
            seatTubeCTText.setAttribute('font-weight', 'bold');
            seatTubeCTText.textContent = `SEAT TUBE C-T: ${seatTube}mm`;
            svg.appendChild(seatTubeCTText);

            // Seat angle label
            const seatAngleText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            seatAngleText.setAttribute('x', bbX - 80);
            seatAngleText.setAttribute('y', bbY - 20);
            seatAngleText.setAttribute('class', 'measurement-text');
            seatAngleText.setAttribute('font-size', '12px');
            seatAngleText.textContent = `SEAT ANGLE: ${seatAngle}¬∞`;
            svg.appendChild(seatAngleText);

            // 6. Draw HEAD TUBE
            const headTubeElement = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            headTubeElement.setAttribute('x1', headTubeTopX);
            headTubeElement.setAttribute('y1', headTubeTopY);
            headTubeElement.setAttribute('x2', headTubeBottomX);
            headTubeElement.setAttribute('y2', headTubeBottomY);
            headTubeElement.setAttribute('stroke', '#34495e');
            headTubeElement.setAttribute('stroke-width', '6');
            headTubeElement.setAttribute('stroke-linecap', 'round');
            svg.appendChild(headTubeElement);

            // Head tube measurement line
            const headTubeMeasurementLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            headTubeMeasurementLine.setAttribute('x1', headTubeTopX);
            headTubeMeasurementLine.setAttribute('y1', headTubeTopY);
            headTubeMeasurementLine.setAttribute('x2', headTubeBottomX);
            headTubeMeasurementLine.setAttribute('y2', headTubeBottomY);
            headTubeMeasurementLine.setAttribute('stroke', '#9b59b6');
            headTubeMeasurementLine.setAttribute('stroke-width', '2');
            headTubeMeasurementLine.setAttribute('stroke-dasharray', '3,3');
            svg.appendChild(headTubeMeasurementLine);

            // Head tube length label
            const headTubeText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            headTubeText.setAttribute('x', headTubeBottomX + 15);
            headTubeText.setAttribute('y', (headTubeTopY + headTubeBottomY) / 2);
            headTubeText.setAttribute('class', 'measurement-text');
            headTubeText.setAttribute('font-weight', 'bold');
            headTubeText.textContent = `HEAD TUBE: ${headTube}mm`;
            svg.appendChild(headTubeText);

            // Head angle label
            const headAngleText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            headAngleText.setAttribute('x', headTubeTopX + 20);
            headAngleText.setAttribute('y', headTubeTopY - 5);
            headAngleText.setAttribute('class', 'measurement-text');
            headAngleText.setAttribute('font-size', '12px');
            headAngleText.textContent = `HEAD ANGLE: ${headAngle}¬∞`;
            svg.appendChild(headAngleText);

            // 6. Add labels for the points
            const bbLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            bbLabel.setAttribute('x', bbX);
            bbLabel.setAttribute('y', bbY + 25);
            bbLabel.setAttribute('text-anchor', 'middle');
            bbLabel.setAttribute('class', 'measurement-text');
            bbLabel.setAttribute('font-size', '12px');
            bbLabel.textContent = 'BB CENTER';
            svg.appendChild(bbLabel);

            const headLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
            headLabel.setAttribute('x', headTubeTopX);
            headLabel.setAttribute('y', headTubeTopY - 10);
            headLabel.setAttribute('text-anchor', 'middle');
            headLabel.setAttribute('class', 'measurement-text');
            headLabel.setAttribute('font-size', '12px');
            headLabel.textContent = 'HEAD TUBE TOP';
            svg.appendChild(headLabel);
        }





        // Load test data for 54T Strael
        function loadStrael54T() {
            // Frame geometry
            document.getElementById('reach').value = 378;
            document.getElementById('stack').value = 580;
            document.getElementById('topTube').value = 548;
            document.getElementById('seatTube').value = 536;
            document.getElementById('headAngle').value = 72.25;
            document.getElementById('seatAngle').value = 73.75;
            document.getElementById('headTube').value = 157;
            document.getElementById('bbDrop').value = 72;

            // Bike fit (optimal values)
            document.getElementById('saddleHeight').value = 760;
            document.getElementById('saddleTipToBB').value = 91;
            document.getElementById('saddleToBarHeight').value = -64;
            document.getElementById('saddleTipToBarCenter').value = 550;

            // Calculate and show test results
            calculateBikeFit();
            
            const stemResult = parseFloat(document.getElementById('stemLength').textContent);
            const seatpostResult = parseFloat(document.getElementById('seatpostSetback').textContent);
            
            let testMessage = `Test Results:<br>`;
            testMessage += `Stem: ${Math.round(stemResult)}mm (Target: ~90mm) `;
            testMessage += Math.abs(stemResult - 90) < 15 ? '<span class="success">‚úÖ</span>' : '<span class="warning">‚ùå</span>';
            testMessage += `<br>Seatpost: ${seatpostResult.toFixed(1)}mm (Target: ~25mm) `;
            testMessage += Math.abs(seatpostResult - 25) < 10 ? '<span class="success">‚úÖ</span>' : '<span class="warning">‚ùå</span>';
            
            document.getElementById('testResults').innerHTML = testMessage;
        }

        // Add event listeners to all inputs
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('input', calculateBikeFit);
            });
        });
    </script>
</body>
</html>